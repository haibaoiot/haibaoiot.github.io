---
layout: page
title: 规则
---

    规则引擎允许您处理具有可配置规则集的设备的消息。
	
- [规则与插件](#规则与插件)
- [范围](#范围)
- [生命周期](#生命周期)	
- [规则](#规则)
	- [过滤器](#过滤器)
	- [处理器](#处理器)
	- [行动](#行动)
- [插件](#插件)
	- [REST API](#REST API)
	- [Websocket API](#Websocket API)
	- [聚类API](#聚类API)
	- [实施](#实施)
- [故障排除和统计](#故障排除和统计)
	- [统计](#统计)
	- [错误](#错误)
	- [生命周期事件](#生命周期事件)


规则管理用户界面页显示系统和租户特定规则的表。每个规则有一个单独的卡。
你可以做以下操作：
-导入或创建新规则
导出规则到JSON
-暂停并激活特定规则
-删除规则
见* *规则引擎*（/文件/用户指南/规则引擎）文档的更多细节。

![图像](http://help.gzhaibaogd.com/images/user-guide/ui/rules.png)

# #规则细节
每个规则都表示为单独的卡。您可以编辑规则组件并在规则详细信息面板中查看规则事件。

![图像](http://help.gzhaibaogd.com/images/user-guide/ui/rule-details.png)

您还可以在消息处理过程中检查规则生命周期事件、规则统计和错误。
请注意，在频繁的错误的情况下，错误消息进行采样。

![图像](http://help.gzhaibaogd.com/images/user-guide/ui/rule-events.png)

（/图片/用户指南/ UI /规则事件。PNG）
# #规则导入/导出
# # # #规则出口
你可以导出你的规则以JSON格式导入到同一个或另一个thingsboard实例。
为了导出规则，您应该导航到**规则**页，然后单击位于特定规则卡上的导出按钮。

![](http://help.gzhaibaogd.com/images/user-guide/ui/rule-export.png)

！[图像]（/图片/用户指南/用户界面/规则导出）
# # # #规则导入
类似的，导入规则，你应该导航到**规则*页，然后点击屏幕右下角的大“+”按钮，然后点击“导入”按钮。

![](http://help.gzhaibaogd.com/images/user-guide/ui/rule-import.png)

！[图像]（/图像/用户指南/用户界面/规则导入）
** * * *所有进口规则均处于暂停状态。别忘了在进口后激活你的规则。
# # # #故障排除
导入规则时可能出现的问题：
-相应的目标插件是*不是进口*。
-相应的目标插件是*未激活*。

使用规则引擎可以：

- 设备属性更改时发送电子邮件。
- 当遥测值超过一定阈值时，会产生报警。
- 将遥测数据转发到Kafka，RabbitMQ或外部RESTful服务器。
- 更多使用其他规则和插件。
- 
**注意**  我们建议在继续操作之前熟悉基本的物联网功能 - （ 属性， 遥测和 RPC）。

规则引擎运行两个主要组件：规则和插件。规则引擎的工作是将配置的规则顺序应用于传入的消息。虽然顺序应用规则，但规则执行是异步的，并且基于actors。这允许以与它们相同的顺序处理来自设备的消息而不牺牲性能。

处理结果可能也可能不会传回设备应用程序。这取决于规则配置。例如，您可以将传入的遥测数据推送到Cassandra DB内部，同时将其发送到Kafka。您可以配置为忽略Kafka错误或将错误报告回设备。在这种情况下，设备可以重试操作，将数据重新发送到不同的服务器，或者简单地忽略该错误。

 ![image](/images/rule-engine.svg)

## 规则与插件

我们将回顾下面的例子来解释Rule和Plugin之间的区别。假设当发动机温度过高时，您想要向工程师发送电子邮件。在这种情况下，规则负责分析遥测数据和建立电子邮件（身体，到，cc等）。但是，插件负责与电子邮件服务器的实际通信并发送电子邮件。因此，多个规则可以使用一次配置的相同的电子邮件插件。

## 范围

规则和插件可能在系统和租户层面上运行。
系统级规则和插件由系统管理员管理。他们处理所有设备的消息。
租户层级规则和插件由相应的租户管理员管理。他们处理属于特定租户的设备的消息。租户级规则能够定位系统级插件。例如，您可以配置在系统级发送通知的插件。您需要在插件配置中指定您的电子邮件帐户。但是，所有租户级别的规则可能会使用此插件来发送电子邮件通知。

